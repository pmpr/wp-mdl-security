(()=>{"use strict";var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var i in a)t.o(a,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=jQuery;var a=t.n(e);if(void 0!==a()){let i=!1;function c(t){a()(this).isRecaptchaLoaded()||(t.preventDefault(),t.stopImmediatePropagation(),alert(PMPRUtil.getSettingByPath("security.recaptcha.messages.timeout")))}a()(window).on("load",(function(){"v3"===PMPRUtil.getSettingByPath("security.recaptcha.version","")||a()(this).isRecaptchaLoaded()||a()("[data-recaptcha_disabled]").removeAttr("disabled").on("click",c).restoreTitle()})),a()(document).ready((function(){a()(this).isRecaptchaLoaded()||a()(".recaptcha").each((function(){a()(this).closest("form").find("input:submit, button:submit").filter(":not(:disabled)").attr("disabled","disabled").attr("data-recaptcha_disabled","true").each((function(){let t="in_progress";PMPRUtil.getSettingByPath("security.recaptcha.options.disable")&&(t="pass_recaptcha"),a()(this).storeTitle(),a()(this).attr("title",PMPRUtil.getSettingByPath(`security.recaptcha.messages.${t}`))}))})),a()("form").on("focus","input, select, textarea",(function(t){let e=a()(this),i=PMPRUtil.getSettingByPath("security.recaptcha.js"),c=e.closest("form:not(.recaptcha-rendered)");PMPRUtil.isEmpty(c)||PMPRUtil.isEmpty(c.find(".recaptcha"))||(PMPRUtil.loadResource(i),function(){let t=0,e=setInterval((function(){if("undefined"!=typeof Recaptcha||"undefined"!=typeof grecaptcha)try{a()(this).prepareRecaptcha(),t=10}catch(t){console.log(t)}t++,t>=10&&clearInterval(e)}),1e3)}(),c.addClass("recaptcha-rendered"))})),a()("body").on("reset_recaptcha",(function(){"v3"===PMPRUtil.getSettingByPath("security.recaptcha.version","")?a()(this).initRecaptchaV3():"undefined"!=typeof grecaptcha&&grecaptcha.reset()}))})),function(t){t.fn.storeTitle=function(){let e=t(this),a=void 0!==e.attr("title")?e.attr("title"):"";e.attr("data-storedTitle",a)},t.fn.restoreTitle=function(){let e=t(this),a=e.attr("data-storedTitle");""!==a?e.attr("title",a):e.removeAttr("title"),e.removeAttr("data-storedTitle")},t.fn.resetRecaptcha=function(){},t.fn.getRecaptchaId=function(){let e="recaptcha_"+Math.floor(1e3*Math.random());return t("#"+e).length&&(e=t(this).getRecaptchaId()),e},t.fn.initRecaptchaV3=function(){let e=window.location.pathname+window.location.search,a=PMPRUtil.getSettingByPath("security.recaptcha");e=e.replace(/[^a-zA-Z0-9 ]/g,"_"),grecaptcha.execute(a.sitekey,{action:"reCaptcha_"+e}).then((function(e){document.querySelectorAll("#"+a.input).forEach((function(a){a.value=e;let i=t(a).closest("form").find("input:submit, button:submit");PMPRUtil.isEmpty(i)||i.prop("disabled",!1).restoreTitle()}))}))},t.fn.prepareRecaptcha=function(){let e=PMPRUtil.getSettingByPath("security.recaptcha"),a=e.version;t(".recaptcha_v2, .recaptcha_invisible").each((function(){let a=t(this),i=a.find(".recaptcha-container");i.is(":empty")&&(e.vars.visibility||a.is(":visible")===a.is(":not(:hidden)"))&&a.displayRecaptcha(t("#"+i.attr("id")))})),"v3"===a&&grecaptcha.ready((function(){t(this).initRecaptchaV3()})),"v2"!==a&&"invisible"!==a||(t(".g-recaptcha").each((function(){let a=t(this);if(""===a.html()&&""===a.text()){let t=a.attr("id");void 0===t&&(t=a.getRecaptchaId(),a.attr("id",t));let i=a.attr("data-sitekey"),c=a.attr("data-theme"),n=a.attr("data-lang"),r=a.attr("data-size"),o=a.attr("data-type"),s=a.attr("data-tabindex"),l=a.attr("data-callback"),d=a.attr("data-expired-callback"),p=a.attr("data-stoken"),h=[];h.sitekey=i||e.sitekey,c&&(h.theme=c),n&&(h.lang=n),r&&(h.size=r),o&&(h.type=o),s&&(h.tabindex=s),l&&(h.callback=l),d&&(h["expired-callback"]=d),p&&(h.stoken=p),a.displayRecaptcha(t,h)}})),t("form").each((function(){t(this).contents().find('iframe[title="recaptcha widget"]').length>1&&!t(this).children(".recaptcha_duplicate_error").length&&t(this).prepend(e.error)})))},t.fn.isRecaptchaLoaded=function(){return void 0!==i&&i},t.fn.displayRecaptcha=function(e,a){let i=PMPRUtil.getSettingByPath("security.recaptcha"),c=a||{sitekey:i.sitekey,theme:"light",size:"normal"},n=e.attr("id"),r=e.closest("form"),o=r.find("input:submit, button:submit"),s=i.version;if(!PMPRUtil.isEmpty(e)&&!PMPRUtil.isEmpty(i)){function l(e){let a=e,i=t._data(e.get(0),"events");if(void 0!==i){let e={};t.extend(!0,e,i),a.off(),a.data("storedEvents",e)}void 0!==a.attr("onclick")&&(a.attr("recaptcha-onclick",a.attr("onclick")),a.removeAttr("onclick"))}function d(t){let e=t,a=e.data("storedEvents");if(void 0!==a)for(let t in a)for(let i=0;i<a[t].length;i++)e.on(t,a[t][i]);e.removeData("storedEvents"),void 0!==e.attr("recaptcha-onclick")&&(e.attr("onclick",e.attr("recaptcha-onclick")),e.removeAttr("recaptcha-onclick"))}function p(e,a){e.on("submit",(function(c){if(""===e.find("."+i.input).val()){c.preventDefault(),c.stopImmediatePropagation();t(c.target||c.srcElement||c.targetObject),c.type;grecaptcha.execute(a)}})),o.on("click",(function(c){if(""===e.find("."+i.input).val()){c.preventDefault(),c.stopImmediatePropagation();t(c.target||c.srcElement||c.targetObject),c.type;grecaptcha.execute(a)}}))}if("v2"===s&&i.disable&&e.closest("form").find("input:submit, button:submit").prop("disabled",!0),"v2"===s){let h=e.parent().width();(h<300&&0!==h||t(window).width()<400)&&(c.size="compact"),PMPRUtil.isEmpty(o)||t("body").hasClass("wp-admin")||(c.callback=function(){o.prop("disabled",!1).restoreTitle()},c["expired-callback"]=function(){o.prop("disabled",!0).storeTitle()});let f=grecaptcha.render(n,c);e.data("recaptcha_index",f)}else if("invisible"===s){let u=!1,g=!1,m=t("body");if(c.size="invisible",c.tabindex=9999,r.length){l(r),o.each((function(){l(t(this))})),m.hasClass("wp-admin")||(c.callback=function(e){r.off(),d(r),o.off().each((function(){d(t(this))})),u&&g&&u.trigger(g),o.each((function(){l(t(this))})),l(r),p(r,y),grecaptcha.reset(y)});let y=grecaptcha.render(n,c);e.data({recaptcha_index:y}),m.hasClass("wp-admin")||p(r,y)}}}}}(jQuery)}})();