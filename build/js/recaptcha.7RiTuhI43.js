(()=>{"use strict";var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var i in a)t.o(a,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=jQuery;var a=t.n(e);if(void 0!==a()){let t=!1;function i(t){a()(this).isRecaptchaLoaded()||(t.preventDefault(),t.stopImmediatePropagation(),alert(PMPRUtil.getSettingByPath("security.recaptcha.messages.timeout")))}a()(window).on("load",(function(){"v3"===PMPRUtil.getSettingByPath("security.recaptcha.version","")||a()(this).isRecaptchaLoaded()||a()("[data-recaptcha_disabled]").removeAttr("disabled").on("click",i).restoreTitle()})),a()(document).ready((function(){a()(this).isRecaptchaLoaded()||a()(".recaptcha").each((function(){a()(this).closest("form").find("input:submit, button:submit").filter(":not(:disabled)").attr("disabled","disabled").attr("data-recaptcha_disabled","true").each((function(){let t="in_progress";PMPRUtil.getSettingByPath("security.recaptcha.options.disable")&&(t="pass_recaptcha"),a()(this).storeTitle(),a()(this).attr("title",PMPRUtil.getSettingByPath(`security.recaptcha.messages.${t}`))}))})),a()("form").on("focus","input, select, textarea",(function(t){let e=a()(this),i=PMPRUtil.getSettingByPath("security.recaptcha.js"),c=e.closest("form:not(.recaptcha-rendered)");PMPRUtil.isEmpty(c)||PMPRUtil.isEmpty(c.find(".recaptcha"))||(PMPRUtil.loadResource(i),function(){let t=0,e=setInterval((function(){if("undefined"!=typeof Recaptcha||"undefined"!=typeof grecaptcha)try{a()(this).prepareRecaptcha(),t=10}catch(t){console.log(t)}t++,t>=10&&clearInterval(e)}),1e3)}(),c.addClass("recaptcha-rendered"))})),a()("body").on("reset_recaptcha",(function(){"v3"===PMPRUtil.getSettingByPath("security.recaptcha.version","")?a()(this).initRecaptchaV3():"undefined"!=typeof grecaptcha&&grecaptcha.reset()}))})),function(e){e.fn.storeTitle=function(){let t=e(this),a=void 0!==t.attr("title")?t.attr("title"):"";t.attr("data-storedTitle",a)},e.fn.restoreTitle=function(){let t=e(this),a=t.attr("data-storedTitle");""!==a?t.attr("title",a):t.removeAttr("title"),t.removeAttr("data-storedTitle")},e.fn.resetRecaptcha=function(){},e.fn.getRecaptchaId=function(){let t="recaptcha_"+Math.floor(1e3*Math.random());return e("#"+t).length&&(t=e(this).getRecaptchaId()),t},e.fn.initRecaptchaV3=function(){let t=window.location.pathname+window.location.search,a=PMPRUtil.getSettingByPath("security.recaptcha");t=t.replace(/[^a-zA-Z0-9 ]/g,"_"),grecaptcha.execute(a.sitekey,{action:"reCaptcha_"+t}).then((function(t){document.querySelectorAll("#"+a.input).forEach((function(a){a.value=t;let i=e(a).closest("form").find("input:submit, button:submit");PMPRUtil.isEmpty(i)||i.prop("disabled",!1).restoreTitle()}))}))},e.fn.prepareRecaptcha=function(){let t=PMPRUtil.getSettingByPath("security.recaptcha"),a=t.version;e(".recaptcha_v2, .recaptcha_invisible").each((function(){let a=e(this),i=a.find(".recaptcha-container");i.is(":empty")&&(t.vars.visibility||a.is(":visible")===a.is(":not(:hidden)"))&&a.displayRecaptcha(e("#"+i.attr("id")))})),"v3"===a&&grecaptcha.ready((function(){e(this).initRecaptchaV3()})),"v2"!==a&&"invisible"!==a||(e(".g-recaptcha").each((function(){let a=e(this);if(""===a.html()&&""===a.text()){let e=a.attr("id");void 0===e&&(e=a.getRecaptchaId(),a.attr("id",e));let i=a.attr("data-sitekey"),c=a.attr("data-theme"),n=a.attr("data-lang"),r=a.attr("data-size"),o=a.attr("data-type"),s=a.attr("data-tabindex"),l=a.attr("data-callback"),d=a.attr("data-expired-callback"),p=a.attr("data-stoken"),h=[];h.sitekey=i||t.sitekey,c&&(h.theme=c),n&&(h.lang=n),r&&(h.size=r),o&&(h.type=o),s&&(h.tabindex=s),l&&(h.callback=l),d&&(h["expired-callback"]=d),p&&(h.stoken=p),a.displayRecaptcha(e,h)}})),e("form").each((function(){e(this).contents().find('iframe[title="recaptcha widget"]').length>1&&!e(this).children(".recaptcha_duplicate_error").length&&e(this).prepend(t.error)})))},e.fn.isRecaptchaLoaded=function(){return void 0!==t&&t},e.fn.displayRecaptcha=function(t,a){let i=PMPRUtil.getSettingByPath("security.recaptcha"),c=a||{sitekey:i.sitekey,theme:"light",size:"normal"},n=t.attr("id"),r=t.closest("form"),o=r.find("input:submit, button:submit"),s=i.version;if(!PMPRUtil.isEmpty(t)&&!PMPRUtil.isEmpty(i)){function l(t){let a=t,i=e._data(t.get(0),"events");if(void 0!==i){let t={};e.extend(!0,t,i),a.off(),a.data("storedEvents",t)}void 0!==a.attr("onclick")&&(a.attr("recaptcha-onclick",a.attr("onclick")),a.removeAttr("onclick"))}function d(t){let e=t,a=e.data("storedEvents");if(void 0!==a)for(let t in a)for(let i=0;i<a[t].length;i++)e.on(t,a[t][i]);e.removeData("storedEvents"),void 0!==e.attr("recaptcha-onclick")&&(e.attr("onclick",e.attr("recaptcha-onclick")),e.removeAttr("recaptcha-onclick"))}function p(t,a){t.on("submit",(function(c){if(""===t.find("."+i.input).val()){c.preventDefault(),c.stopImmediatePropagation();e(c.target||c.srcElement||c.targetObject),c.type;grecaptcha.execute(a)}})),o.on("click",(function(c){if(""===t.find("."+i.input).val()){c.preventDefault(),c.stopImmediatePropagation();e(c.target||c.srcElement||c.targetObject),c.type;grecaptcha.execute(a)}}))}if("v2"===s&&i.disable&&t.closest("form").find("input:submit, button:submit").prop("disabled",!0),"v2"===s){let a=t.parent().width();(a<300&&0!==a||e(window).width()<400)&&(c.size="compact"),PMPRUtil.isEmpty(o)||e("body").hasClass("wp-admin")||(c.callback=function(){o.prop("disabled",!1).restoreTitle()},c["expired-callback"]=function(){o.prop("disabled",!0).storeTitle()});let i=grecaptcha.render(n,c);t.data("recaptcha_index",i)}else if("invisible"===s){let a=!1,i=!1,s=e("body");if(c.size="invisible",c.tabindex=9999,r.length){l(r),o.each((function(){l(e(this))})),s.hasClass("wp-admin")||(c.callback=function(t){r.off(),d(r),o.off().each((function(){d(e(this))})),a&&i&&a.trigger(i),o.each((function(){l(e(this))})),l(r),p(r,h),grecaptcha.reset(h)});let h=grecaptcha.render(n,c);t.data({recaptcha_index:h}),s.hasClass("wp-admin")||p(r,h)}}}}}(jQuery)}})();